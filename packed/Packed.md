# Packed Lab

## File
- Packed.exe
- Size: 5632 bytes
- MD5: ecb79a0b5a0f06c85e7f0a8f613d1d27
- SHA1: 92154a20b26e5e57181003b07a796fde1c618719
- SHA256: a449c001968588a2ff656895ade79713248a9f45fa6e22b47e7828706173411e

## Virus Total
* Detection ratio: 46/57
* Pasta trojan (If that doesn't sound familiar, see [lab 1](../static-analisys))

## Packer Detection
- Detect It Easy - reports UPX 3.04
- RDG Packer detector - reports UPX 3.04

## Unpacking
```sh
cp Packed.exe UnPacked.exe
upx -d UnPacked.exe
```
Success!

## Unpacked
- Size: 7680 bytes
- MD5: 57dcbf2f7493eda2a85831fab39dec89
- SHA1: cf33265c9f720a97392d5f2a254b3c5c4bceadc3
- SHA256: 61a32fa576ae3240a57563c4ab6e6aa4f91a48660d5769c4c93a3c36f04174fd

Size matches StaticAnalysis.exe, but the hashes differ. Is the behaviour the same?

## Analysis: Packed.exe and StaticAnalysis.exe
###vbindiff
The files appear to be about 80% the same.

###strings
The list of strings is similar but not the same.

Commands and URLs appear to be the same.

###PEStudio / PEBrowse
.text sections are the same, verified via hash - the code must be identical

The relocation information in UnPacked.exe is stripped, but available in StaticAnalysis.exe

There is a debug section in StaticAnalysis.exe, but missing in UnPacked.exe

StaticAnalysis.exe contains 76 bytes of ASCII padding, but can't find anything referencing that area of memory.

###IDA Pro
Loading UnPAcked.exe into IDA and comparing to StaticAnalysis.exe shows same behavious.

## Conclusion
Packed.exe is a PE binary packed with UPX v3.04.

Packed.exe exibits the same behaviour as StaticAnalysis.exe

Packed.exe is not exactly the same StaticAnalysis.exe, but I was not able to find anything interesting in the differences.